---
layout: custom_post
title: "如何用生成函數解遞迴關係式"
date: 2025-11-27
update: 2025-12-01
author: "Berry"
tags: [離散數學, 生成函數]
---

我真的快被這鬼東西搞爆了，趕快在我剛懂得時候記錄下來

## 什麼是生成函數(Generating Function)

就是把數列包裝成一個多項式 (可以有限項或無限項)

$$
A(x) = \sum_{n=0}^{\infty}a_nx^n = a_0 + a_1x + a_2x^2 + ...
$$

某些特定的係數組合可以用簡單的方法表示出來

例如 

$$
\left\{1,1,1,1,...,1\right\} = \frac{1}{1-x} = \sum_{n=0}^{\infty} x^n
$$

## 怎麼用來解遞迴關係式

考慮一個遞迴關係式

$
a_n = 3a_{n-1} + 2 \space (n \ge 1) \space 且 \space a_0 = 1
$

套換成無限級數的形式 

也就是說可以想像成

$a_1$ 對應  $3a_0 + 2 $

$a_2$ 對應  $3a_1 + 2 $

然後這樣無限對應下去變成下面這個式子

$$
\sum_{n=1}^{\infty} a_n x^n = \sum_{n=1}^{\infty} 3a_{n-1} x^n + \sum_{n=1}^{\infty} 2x^n
$$

可以看出來把多項式套進去不影響等式 (只是把項數變無限然後乘上 $x$ )

接下來上面這些求和都跟原本的生成函式有點小差距

所以我們把這些差距補回來

$$
\sum_{n=1}^{\infty} a_n x^n  = A(x) - a_0
$$

$$
\sum_{n=1}^{\infty} 3a_{n-1} x^n  = 3xA(x)
$$

$$
\sum_{n=1}^{\infty} 2x^n  = \frac{2x}{1-x}
$$

整理後原式變成

$$
A(x) - a_0 = 3x A(x) + \frac{2x}{1-x}
$$

現在透過初始條件 $a_0 = 1$ 我們可以找出 $A(x)$ 了

$$
A(x) - 1 = 3x A(x) + \frac{2x}{1-x}
$$

含有 $A(x)$ 的移到同一邊

$$
A(x) - 3x A(x) = 1 + \frac{2x}{1-x}
$$

把 $A(x)$ 抽出來

$$
A(x)(1-3x) = \frac{1-x}{1-x} + \frac{2x}{1-x}
$$

把 $(1-3x)$ 除到右邊

$$
A(x) = \frac{1+x}{(1-x)(1-3x)}
$$

求出來之後 我們試著把右邊改回求和的形式

首先要做部分分式 (這東西我從小到大式都沒學過啦，但這裡需要 D: )

把 $A(x)$ 的兩個相乘的分母分開

$$
A(x) = \frac{1+x}{(1-x)(1-3x)} = \frac{C_1}{1-x} + \frac{C_2}{1-3x}
$$

通分

$$
1+x = (1-3x)C_1 + (1-x)C_2
$$

$x$ 代入 $1$ 消掉 $C_2$

$$
2 = -2C_1 \implies C_1 = -1
$$

$x$ 代入 $1/3$ 消掉 $C_1$

$$
\frac{4}{3} = \frac{2}{3}C_2 \implies C_2 = 2
$$

$$
A(x) = \frac{-1}{1-x} + \frac{2}{1-3x}
$$

現在我們可以換回球和符號了

$$
A(x) = -\sum_{n=1}^{\infty}x^n + 2\sum_{n=1}^{\infty}(3x)^n
$$

$$
A(x) = \sum_{n=1}^{\infty}-1 \cdot x^n + \sum_{n=1}^{\infty}2 \cdot 3^nx^n
$$

$$
A(x) = \sum_{n=1}^{\infty}(-1 + 2 \cdot 3^n)x^n
$$

還記得一開始的公式嗎 :)

$$
A(x) = \sum_{n=0}^{\infty}a_nx^n
$$

也就是

$$
a_n = 2 \cdot 3^n - 1
$$

費了好多力氣終於把通項求出來了 可喜可賀